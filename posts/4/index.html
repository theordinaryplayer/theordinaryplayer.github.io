<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="https://k.top4top.io/p_3585nrb3e0.png"/><link rel="stylesheet" href="/_next/static/css/57ead594feaf2ad3.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-68f22649503f8e75.js"/><script src="/_next/static/chunks/4bd1b696-21cefdb9a3c74919.js" async=""></script><script src="/_next/static/chunks/684-67bf5e352b5e569a.js" async=""></script><script src="/_next/static/chunks/main-app-8e5570192ec42145.js" async=""></script><script src="/_next/static/chunks/874-0715c6660f33056f.js" async=""></script><script src="/_next/static/chunks/app/layout-72ec80e2b32a7cbd.js" async=""></script><script src="/_next/static/chunks/app/posts/%5Bid%5D/page-ba617bb0ce8d0e66.js" async=""></script><title>Uncovering Local File Inclusion Vulnerabilities: A Practical Approach to Path Traversal Hunting</title><meta name="description" content="A blog post by Rosemary about cybersecurity"/><link rel="icon" href="/favicon.ico"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="antialiased bg-background text-foreground font-sans"><nav class="fixed top-0 w-full z-50 bg-gradient-to-b from-black via-black/80 to-transparent"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex justify-between items-center h-16"><a class="flex items-center gap-2" href="/"><img src="https://k.top4top.io/p_3585nrb3e0.png" alt="TRICK OR TREAT" width="80"/></a><div class="hidden md:flex gap-8"><a class="text-foreground hover:text-primary transition-colors" href="/">Home</a><a class="text-foreground hover:text-primary transition-colors" href="/members/">Members</a><a class="text-foreground hover:text-primary transition-colors" href="/writeups/">Writeups</a><a class="text-foreground hover:text-primary transition-colors" href="/posts/">Posts</a></div><button class="md:hidden text-foreground"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></div></div></nav><main class="min-h-screen"><div class="pt-12"><article class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8"><header class="mb-12 border-b pb-8"><div class="mb-10"></div><h1 class="text-4xl md:text-5xl font-bold text-foreground mb-6">Uncovering Local File Inclusion Vulnerabilities: A Practical Approach to Path Traversal Hunting</h1><div class="flex items-center gap-6 text-sm text-muted-foreground"><div class="flex items-center gap-2"><span>By <!-- -->Rosemary</span></div><div><span>11/3/2025</span></div></div></header><div class="prose prose-lg max-w-none"><p class="markdown-p my-4 leading-relaxed">Local File Inclusion (LFI) is one of the most common yet impactful vulnerabilities in modern web applications. It arises when user-supplied input is used to build file paths without proper sanitization or validation. Exploiting LFI can lead to unauthorized access to sensitive system files, information disclosure, or even remote code execution under specific conditions.</p>
<p class="markdown-p my-4 leading-relaxed"><img src="https://i0.wp.com/lab.wallarm.com/wp-content/uploads/2021/12/Local-File-Inclusion-work.png?resize=770%2C462&amp;ssl=1" alt="1" class=""></p>
<p class="markdown-p my-4 leading-relaxed"><strong class="markdown-strong font-bold">Overview</strong></p>
<p class="markdown-p my-4 leading-relaxed">Local File Inclusion (LFI) occurs when an application constructs filesystem paths from user-controlled input without proper validation. An attacker who can control the included path may read sensitive files, enumerate users, leak configuration secrets, or—in certain setups—lead to remote code execution. This guide shows a practical, defensible methodology for finding and validating LFI/path-traversal issues and how to harden systems against them. <strong class="markdown-strong font-bold">Only test targets you own or have explicit authorization to test.</strong></p>
<hr class="markdown-hr my-6 h-px border-0 bg-border">
<h2 class="markdown-h2 text-2xl font-bold mt-6 mb-4">1 — What is LFI (short and sharp)</h2>
<p class="markdown-p my-4 leading-relaxed">An LFI happens when code like this takes user input and includes it directly:</p>
<pre class="markdown-pre rounded-md bg-muted p-4 overflow-x-auto"><code class="hljs language-php markdown-code font-mono text-sm"><span class="hljs-keyword">include</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'page'</span>]);
</code></pre>
<p class="markdown-p my-4 leading-relaxed">If <code class="markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded">page</code> is not restricted, an attacker can change what file the server includes. Root causes are usually:</p>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2">Missing input validation or allowlists</li>
<li class="markdown-li my-2">Concatenation of user input into file paths</li>
<li class="markdown-li my-2">Exposed dev/backups or predictable file locations</li>
</ul>
<p class="markdown-p my-4 leading-relaxed">Mapping the weakness to CWE: this is typically <strong class="markdown-strong font-bold">CWE-22 (Path Traversal)</strong> and sometimes <strong class="markdown-strong font-bold">CWE-98/CWE-94</strong> if inclusion leads to code execution.</p>
<hr class="markdown-hr my-6 h-px border-0 bg-border">
<h2 class="markdown-h2 text-2xl font-bold mt-6 mb-4">2 — Recon &amp; parameter discovery (safe, non-destructive)</h2>
<p class="markdown-p my-4 leading-relaxed">Goal: enumerate endpoints and parameters that accept file-like input.</p>
<p class="markdown-p my-4 leading-relaxed">Useful tools &amp; commands:</p>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Gather archived URLs</strong> (public sources)</li>
</ul>
<pre class="markdown-pre rounded-md bg-muted p-4 overflow-x-auto"><code class="hljs language-bash markdown-code font-mono text-sm">gau example.com &gt; urls.txt
</code></pre>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2">
<p class="markdown-p my-4 leading-relaxed"><strong class="markdown-strong font-bold">Crawl &amp; spider</strong> (Burp Spider / Burp Scanner)</p>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2">Use Burp’s crawler to enumerate dynamic endpoints and hidden parameters.</li>
</ul>
</li>
<li class="markdown-li my-2">
<p class="markdown-p my-4 leading-relaxed"><strong class="markdown-strong font-bold">Directory &amp; param discovery</strong> (gobuster / ffuf)</p>
</li>
</ul>
<pre class="markdown-pre rounded-md bg-muted p-4 overflow-x-auto"><code class="hljs language-bash markdown-code font-mono text-sm">gobuster <span class="hljs-built_in">dir</span> -u https://example.com -w /usr/share/wordlists/dirb/common.txt -x php,html -t 50
<span class="hljs-comment"># or</span>
ffuf -u https://example.com/FUZZ -w /usr/share/wordlists/common.txt
</code></pre>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Filter for likely parameters</strong> (look for names that imply file/include)</li>
</ul>
<pre class="markdown-pre rounded-md bg-muted p-4 overflow-x-auto"><code class="hljs language-bash markdown-code font-mono text-sm">grep -Eo <span class="hljs-string">"([?&amp;](file|path|page|include|template|doc|view|download)=[^&amp; ]+)"</span> urls.txt | <span class="hljs-built_in">sort</span> -u
</code></pre>
<p class="markdown-p my-4 leading-relaxed">Focus on parameters like: <code class="markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded">file=</code>, <code class="markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded">page=</code>, <code class="markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded">template=</code>, <code class="markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded">inc=</code>, <code class="markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded">download=</code>, <code class="markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded">path=</code>, <code class="markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded">doc=</code>.</p>
<hr class="markdown-hr my-6 h-px border-0 bg-border">
<h2 class="markdown-h2 text-2xl font-bold mt-6 mb-4">3 — Manual probing (confirming behavior, low-noise)</h2>
<p class="markdown-p my-4 leading-relaxed">Principle: start with non-destructive checks that change <strong class="markdown-strong font-bold">behavior</strong> only (not data extraction). Always log timestamps and keep tests minimal.</p>
<p class="markdown-p my-4 leading-relaxed">Commands for behavioral checks:</p>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Compare responses</strong> (normal vs. manipulated input)</li>
</ul>
<pre class="markdown-pre rounded-md bg-muted p-4 overflow-x-auto"><code class="hljs language-bash markdown-code font-mono text-sm"><span class="hljs-comment"># baseline</span>
curl -s <span class="hljs-string">'https://example.com/view.php?page=home'</span> -o baseline.html
<span class="hljs-comment"># altered (proof of concept must be safe and limited)</span>
curl -s <span class="hljs-string">'https://example.com/view.php?page=..%2Fhome'</span> -o test.html
diff -u baseline.html test.html | <span class="hljs-built_in">head</span>
</code></pre>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Identify error messages / stack traces</strong></li>
</ul>
<pre class="markdown-pre rounded-md bg-muted p-4 overflow-x-auto"><code class="hljs language-bash markdown-code font-mono text-sm">curl -s <span class="hljs-string">'https://example.com/view.php?page=bogus'</span> -D - | sed -n <span class="hljs-string">'1,60p'</span>
</code></pre>
<p class="markdown-p my-4 leading-relaxed">If the app returns filesystem errors or stack traces, it often leaks the server OS or application paths—useful for classification, not exploitation.</p>
<blockquote class="markdown-blockquote my-4 border-l-4 border-primary pl-4 italic text-muted-foreground">
<p class="markdown-p my-4 leading-relaxed"><strong class="markdown-strong font-bold">Safety note:</strong> Do not use destructive payloads (e.g., writing files) on targets without express authorization.</p>
</blockquote>
<hr class="markdown-hr my-6 h-px border-0 bg-border">
<h2 class="markdown-h2 text-2xl font-bold mt-6 mb-4">4 — Typical LFI indicators and tests (explain, not weaponize)</h2>
<p class="markdown-p my-4 leading-relaxed">Indicators that an LFI may be present:</p>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2">Parameter appears in server-side include or <code class="markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded">require</code> logic.</li>
<li class="markdown-li my-2">Application displays file contents or echoes included templates.</li>
<li class="markdown-li my-2">Error messages contain absolute or relative path information.</li>
<li class="markdown-li my-2">Response behavior changes when adding traversal sequences.</li>
</ul>
<p class="markdown-p my-4 leading-relaxed">Common minimal checks (lab/authorized testing):</p>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2">Inject harmless traversal sequences and observe response differences (timing, content length, error).</li>
<li class="markdown-li my-2">Check for inclusion of webroot files that are normally accessible (short, non-sensitive files) to verify include mechanics.</li>
</ul>
<p class="markdown-p my-4 leading-relaxed">Do <strong class="markdown-strong font-bold">not</strong> publish or run destructive commands (e.g., file writes, webshell creation) on production targets you don’t control.</p>
<hr class="markdown-hr my-6 h-px border-0 bg-border">
<h2 class="markdown-h2 text-2xl font-bold mt-6 mb-4">5 — Proof-of-concept &amp; evidence collection (responsible)</h2>
<p class="markdown-p my-4 leading-relaxed">When you have reasonable confidence an LFI exists, collect non-destructive evidence for a report:</p>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2">The vulnerable endpoint and exact parameter name.</li>
<li class="markdown-li my-2">Baseline and altered responses (diffs/screenshots) showing the difference.</li>
<li class="markdown-li my-2">Server headers and any error strings (do not reveal exploited content in public reports).</li>
<li class="markdown-li my-2">Environment fingerprint (OS, server, app stack) gleaned from safe artifacts.</li>
</ul>
<p class="markdown-p my-4 leading-relaxed">Example of documenting a behavioral PoC (conceptual):</p>
<pre class="markdown-pre rounded-md bg-muted p-4 overflow-x-auto"><code class="hljs language-arduino markdown-code font-mono text-sm"><span class="hljs-number">1</span>) Baseline: GET /view.php?page=home  -&gt; <span class="hljs-number">200</span> OK, content X
<span class="hljs-number">2</span>) Test:     GET /view.php?page=../../home -&gt; <span class="hljs-number">200</span> OK, content <span class="hljs-built_in">differs</span> (diff attached)
<span class="hljs-number">3</span>) Observed server header: <span class="hljs-built_in">Server</span>: nginx/<span class="hljs-number">1.18</span><span class="hljs-number">.0</span>
<span class="hljs-number">4</span>) Error output: <span class="hljs-string">"Warning: include(/var/www/html/home): failed to open stream..."</span>
</code></pre>
<p class="markdown-p my-4 leading-relaxed">This is enough for vendors to triage without handing them exploit code.</p>
<hr class="markdown-hr my-6 h-px border-0 bg-border">
<h2 class="markdown-h2 text-2xl font-bold mt-6 mb-4">6 — Escalation scenarios (what makes LFI worse)</h2>
<p class="markdown-p my-4 leading-relaxed">LFI becomes significantly more severe if any of the following apply:</p>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Writable upload directories</strong>: Attacker can upload a file (logs, images) and include it later → RCE.</li>
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Log file inclusion</strong>: If logs are user-injectable and included, attackers can place payloads in logs.</li>
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Remote file inclusion allowed (RFI)</strong>: If remote file includes are enabled, exfil or code execution is easier.</li>
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Privileged DB or exec features</strong>: Access to sensitive files like config with DB credentials increases blast radius.</li>
</ul>
<p class="markdown-p my-4 leading-relaxed">Document whether such conditions exist during assessment — again, only via observation and safe checks.</p>
<hr class="markdown-hr my-6 h-px border-0 bg-border">
<h2 class="markdown-h2 text-2xl font-bold mt-6 mb-4">7 — Defenses: code and deployment fixes</h2>
<p class="markdown-p my-4 leading-relaxed">Concrete, actionable mitigations developers can apply.</p>
<h3 class="markdown-h3 text-xl font-bold mt-6 mb-4">A. Code-level protections</h3>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Allowlist directories</strong> (never accept arbitrary paths):</li>
</ul>
<pre class="markdown-pre rounded-md bg-muted p-4 overflow-x-auto"><code class="hljs language-php markdown-code font-mono text-sm"><span class="hljs-variable">$allowed</span> = [<span class="hljs-string">'home'</span>,<span class="hljs-string">'about'</span>,<span class="hljs-string">'contact'</span>];
<span class="hljs-variable">$page</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'page'</span>] ?? <span class="hljs-string">'home'</span>;
<span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$page</span>, <span class="hljs-variable">$allowed</span>)) { <span class="hljs-title function_ invoke__">http_response_code</span>(<span class="hljs-number">404</span>); <span class="hljs-keyword">exit</span>; }
<span class="hljs-keyword">include</span> <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/pages/'</span> . <span class="hljs-variable">$page</span> . <span class="hljs-string">'.php'</span>;
</code></pre>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Use realpath + validation</strong>:</li>
</ul>
<pre class="markdown-pre rounded-md bg-muted p-4 overflow-x-auto"><code class="hljs language-php markdown-code font-mono text-sm"><span class="hljs-variable">$base</span> = <span class="hljs-title function_ invoke__">realpath</span>(<span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/pages'</span>) . DIRECTORY_SEPARATOR;
<span class="hljs-variable">$path</span> = <span class="hljs-title function_ invoke__">realpath</span>(<span class="hljs-variable">$base</span> . <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'page'</span>]);
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$path</span> === <span class="hljs-literal">false</span> || <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$path</span>, <span class="hljs-variable">$base</span>) !== <span class="hljs-number">0</span>) { <span class="hljs-title function_ invoke__">http_response_code</span>(<span class="hljs-number">403</span>); <span class="hljs-keyword">exit</span>; }
<span class="hljs-keyword">include</span> <span class="hljs-variable">$path</span>;
</code></pre>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Avoid dynamic includes</strong> where possible — use routing or explicit mappings.</li>
</ul>
<h3 class="markdown-h3 text-xl font-bold mt-6 mb-4">B. Configuration &amp; server hardening</h3>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Store uploads outside webroot</strong> and serve via safe proxy that enforces content-type checks.</li>
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Disable risky PHP settings</strong> (<code class="markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded">allow_url_include = Off</code>) and ensure <code class="markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded">open_basedir</code> is set to restrict accessible paths.</li>
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Remove verbose error messages</strong> from production (no stack traces to end-users).</li>
</ul>
<p class="markdown-p my-4 leading-relaxed">Nginx example to block obvious backup files:</p>
<pre class="markdown-pre rounded-md bg-muted p-4 overflow-x-auto"><code class="hljs language-nginx markdown-code font-mono text-sm">location ~* \.(zip|tar|sql|bak)$ {
    deny all;
    return 403;
}
</code></pre>
<h3 class="markdown-h3 text-xl font-bold mt-6 mb-4">C. Principle of least privilege</h3>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2">Application processes should not run as root.</li>
<li class="markdown-li my-2">Limit file system permissions—application should only read files it needs.</li>
</ul>
<hr class="markdown-hr my-6 h-px border-0 bg-border">
<h2 class="markdown-h2 text-2xl font-bold mt-6 mb-4">8 — Detection &amp; monitoring (what defenders should watch for)</h2>
<p class="markdown-p my-4 leading-relaxed">Search logs for suspicious patterns that may indicate traversal attempts:</p>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2">Webserver logs:</li>
</ul>
<pre class="markdown-pre rounded-md bg-muted p-4 overflow-x-auto"><code class="hljs language-bash markdown-code font-mono text-sm"><span class="hljs-comment"># basic heuristic search</span>
grep -Ei <span class="hljs-string">"(\.\./|\.\.\\|%2e%2e|etc/passwd|boot.ini|/proc/self)"</span> /var/log/nginx/access.log | <span class="hljs-built_in">tail</span> -n 200
</code></pre>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2">Monitor application errors for include/failed-open messages:</li>
</ul>
<pre class="markdown-pre rounded-md bg-muted p-4 overflow-x-auto"><code class="hljs language-bash markdown-code font-mono text-sm">grep -i <span class="hljs-string">"failed to open stream"</span> /var/log/php_errors.log
</code></pre>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2">Alert on attempts to access sensitive paths (e.g., <code class="markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded">/etc/passwd</code>, <code class="markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded">/proc/self/environ</code>) from the webapp.</li>
</ul>
<hr class="markdown-hr my-6 h-px border-0 bg-border">
<h2 class="markdown-h2 text-2xl font-bold mt-6 mb-4">9 — Responsible disclosure checklist</h2>
<p class="markdown-p my-4 leading-relaxed">If you find an LFI (authorized testing):</p>
<ol class="markdown-ol my-4 ml-6 list-decimal">
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Document</strong>: endpoint, parameter, controlled test inputs, server fingerprints, and diffs/screenshots.</li>
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Avoid destructive steps</strong>: do not write files, do not trigger RCE in the wild.</li>
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Report privately</strong> to the vendor/owner with a clear remediation suggestion (allowlist + realpath + config changes).</li>
<li class="markdown-li my-2"><strong class="markdown-strong font-bold">Coordinate</strong> timeline for patching and public disclosure per vendor policy.</li>
</ol>
<hr class="markdown-hr my-6 h-px border-0 bg-border">
<h2 class="markdown-h2 text-2xl font-bold mt-6 mb-4">10 — Lab practice (safe environments)</h2>
<p class="markdown-p my-4 leading-relaxed">Set up legal, isolated labs to practice:</p>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2">OWASP Juice Shop (web vulnerabilities playground):</li>
</ul>
<pre class="markdown-pre rounded-md bg-muted p-4 overflow-x-auto"><code class="hljs language-bash markdown-code font-mono text-sm">docker run --<span class="hljs-built_in">rm</span> -p 3000:3000 bkimminich/juice-shop
<span class="hljs-comment"># browse http://localhost:3000</span>
</code></pre>
<ul class="markdown-ul my-4 ml-6 list-disc">
<li class="markdown-li my-2">DVWA (Deliberately Vulnerable Web App) or custom containers with isolated LFI examples.</li>
</ul>
<p class="markdown-p my-4 leading-relaxed">Practice detection and safe evidence collection in these environments before attempting any real-world testing.</p>
<hr class="markdown-hr my-6 h-px border-0 bg-border">
<h2 class="markdown-h2 text-2xl font-bold mt-6 mb-4">Conclusion</h2>
<p class="markdown-p my-4 leading-relaxed">LFI issues are often the result of simple, fixable mistakes: dynamic includes and insufficient input validation. The most important habit for a researcher or dev is to <strong class="markdown-strong font-bold">assume input is hostile</strong>, use allowlists, resolve paths safely (realpath), and run the app with least privilege. When you find an LFI, document behavior, avoid destructive steps, and help the owner patch the root cause.</p></div><div class="mt-12 pt-8 border-t"><a class="text-primary hover:text-primary/80 transition-colors font-semibold inline-flex items-center gap-2" href="/posts/"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-right rotate-180"><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg>Back to Posts</a></div></article></div></main><footer class="bg-black border-t border-primary/20 mt-20"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"><div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8"><div><h3 class="text-xl font-bold gradient-text mb-4">The Ordinary Player</h3><p class="text-muted-foreground">Rookie hackers on a mission to learn, fail, and hack smarter.</p></div><div><h4 class="font-semibold text-foreground mb-4">Navigation</h4><ul class="space-y-2"><li><a class="text-muted-foreground hover:text-primary transition-colors" href="/">Home</a></li><li><a class="text-muted-foreground hover:text-primary transition-colors" href="/members/">Members</a></li></ul></div><div><h4 class="font-semibold text-foreground mb-4">Resources</h4><ul class="space-y-2"><li><a class="text-muted-foreground hover:text-primary transition-colors" href="/posts/">Posts</a></li><li><a class="text-muted-foreground hover:text-primary transition-colors" href="/writeups/">Writeups</a></li></ul></div><div><h4 class="font-semibold text-foreground mb-4">Connect</h4><ul class="space-y-2"><li><a href="#" class="text-muted-foreground hover:text-primary transition-colors">Twitter</a></li><li><a href="#" class="text-muted-foreground hover:text-primary transition-colors">Discord</a></li><li><a href="#" class="text-muted-foreground hover:text-primary transition-colors">GitHub</a></li></ul></div></div><div class="border-t border-primary/20 pt-8 text-center text-muted-foreground"><p>© 2025 The Ordinary Player CTF Team. All rights reserved.</p></div></div></footer><!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template><!--/$--><script src="/_next/static/chunks/webpack-68f22649503f8e75.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[1917,[\"874\",\"static/chunks/874-0715c6660f33056f.js\",\"177\",\"static/chunks/app/layout-72ec80e2b32a7cbd.js\"],\"default\"]\n3:I[7555,[],\"\"]\n4:I[1295,[],\"\"]\n5:I[6874,[\"874\",\"static/chunks/874-0715c6660f33056f.js\",\"880\",\"static/chunks/app/posts/%5Bid%5D/page-ba617bb0ce8d0e66.js\"],\"\"]\n6:I[9742,[\"874\",\"static/chunks/874-0715c6660f33056f.js\",\"177\",\"static/chunks/app/layout-72ec80e2b32a7cbd.js\"],\"Analytics\"]\n8:I[9665,[],\"OutletBoundary\"]\nb:I[9665,[],\"ViewportBoundary\"]\nd:I[9665,[],\"MetadataBoundary\"]\nf:I[6614,[],\"\"]\n:HL[\"/_next/static/css/57ead594feaf2ad3.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"gT2vEjD7AhxX80C1hioEI\",\"p\":\"\",\"c\":[\"\",\"posts\",\"4\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"4\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/57ead594feaf2ad3.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"antialiased bg-background text-foreground font-sans\",\"children\":[[\"$\",\"$L2\",null,{}],[\"$\",\"main\",null,{\"className\":\"min-h-screen\",\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center justify-center min-h-[80vh] px-4 text-center\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-6xl font-bold mb-4 gradient-text\",\"children\":\"404\"}],[\"$\",\"p\",null,{\"className\":\"text-xl text-muted-foreground mb-8\",\"children\":\"Page not found\"}],[\"$\",\"p\",null,{\"className\":\"text-muted-foreground mb-8\",\"children\":\"The page you are looking for might have been removed, had its name changed, or is temporarily unavailable.\"}],[\"$\",\"$L5\",null,{\"href\":\"/\",\"className\":\"px-6 py-3 bg-primary text-black rounded-full hover:bg-primary/90 transition-colors font-semibold\",\"children\":\"Go back home\"}]]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"bg-black border-t border-primary/20 mt-20\",\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12\",\"children\":[[\"$\",\"div\",null,{\"className\":\"grid grid-cols-1 md:grid-cols-4 gap-8 mb-8\",\"children\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"h3\",null,{\"className\":\"text-xl font-bold gradient-text mb-4\",\"children\":\"The Ordinary Player\"}],[\"$\",\"p\",null,{\"className\":\"text-muted-foreground\",\"children\":\"Rookie hackers on a mission to learn, fail, and hack smarter.\"}]]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"h4\",null,{\"className\":\"font-semibold text-foreground mb-4\",\"children\":\"Navigation\"}],[\"$\",\"ul\",null,{\"className\":\"space-y-2\",\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"$L5\",null,{\"href\":\"/\",\"className\":\"text-muted-foreground hover:text-primary transition-colors\",\"children\":\"Home\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$L5\",null,{\"href\":\"/members\",\"className\":\"text-muted-foreground hover:text-primary transition-colors\",\"children\":\"Members\"}]}]]}]]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"h4\",null,{\"className\":\"font-semibold text-foreground mb-4\",\"children\":\"Resources\"}],[\"$\",\"ul\",null,{\"className\":\"space-y-2\",\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"$L5\",null,{\"href\":\"/posts\",\"className\":\"text-muted-foreground hover:text-primary transition-colors\",\"children\":\"Posts\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$L5\",null,{\"href\":\"/writeups\",\"className\":\"text-muted-foreground hover:text-primary transition-colors\",\"children\":\"Writeups\"}]}]]}]]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"h4\",null,{\"className\":\"font-semibold text-foreground mb-4\",\"children\":\"Connect\"}],[\"$\",\"ul\",null,{\"className\":\"space-y-2\",\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#\",\"className\":\"text-muted-foreground hover:text-primary transition-colors\",\"children\":\"Twitter\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#\",\"className\":\"text-muted-foreground hover:text-primary transition-colors\",\"children\":\"Discord\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#\",\"className\":\"text-muted-foreground hover:text-primary transition-colors\",\"children\":\"GitHub\"}]}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"border-t border-primary/20 pt-8 text-center text-muted-foreground\",\"children\":[\"$\",\"p\",null,{\"children\":\"© 2025 The Ordinary Player CTF Team. All rights reserved.\"}]}]]}]}],[\"$\",\"$L6\",null,{}]]}]}]]}],{\"children\":[\"posts\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"id\",\"4\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L7\",\"$undefined\",null,[\"$\",\"$L8\",null,{\"children\":[\"$L9\",\"$La\",null]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"jedxnE3iH34afxciVxvdF\",{\"children\":[[\"$\",\"$Lb\",null,{\"children\":\"$Lc\"}],null]}],[\"$\",\"$Ld\",null,{\"children\":\"$Le\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n9:null\n"])</script><script>self.__next_f.push([1,"10:T5200,"])</script><script>self.__next_f.push([1,"\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eLocal File Inclusion (LFI) is one of the most common yet impactful vulnerabilities in modern web applications. It arises when user-supplied input is used to build file paths without proper sanitization or validation. Exploiting LFI can lead to unauthorized access to sensitive system files, information disclosure, or even remote code execution under specific conditions.\u003c/p\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003e\u003cimg src=\"https://i0.wp.com/lab.wallarm.com/wp-content/uploads/2021/12/Local-File-Inclusion-work.png?resize=770%2C462\u0026amp;ssl=1\" alt=\"1\" class=\"\"\u003e\u003c/p\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eOverview\u003c/strong\u003e\u003c/p\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eLocal File Inclusion (LFI) occurs when an application constructs filesystem paths from user-controlled input without proper validation. An attacker who can control the included path may read sensitive files, enumerate users, leak configuration secrets, or—in certain setups—lead to remote code execution. This guide shows a practical, defensible methodology for finding and validating LFI/path-traversal issues and how to harden systems against them. \u003cstrong class=\"markdown-strong font-bold\"\u003eOnly test targets you own or have explicit authorization to test.\u003c/strong\u003e\u003c/p\u003e\n\u003chr class=\"markdown-hr my-6 h-px border-0 bg-border\"\u003e\n\u003ch2 class=\"markdown-h2 text-2xl font-bold mt-6 mb-4\"\u003e1 — What is LFI (short and sharp)\u003c/h2\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eAn LFI happens when code like this takes user input and includes it directly:\u003c/p\u003e\n\u003cpre class=\"markdown-pre rounded-md bg-muted p-4 overflow-x-auto\"\u003e\u003ccode class=\"hljs language-php markdown-code font-mono text-sm\"\u003e\u003cspan class=\"hljs-keyword\"\u003einclude\u003c/span\u003e(\u003cspan class=\"hljs-variable\"\u003e$_GET\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'page'\u003c/span\u003e]);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eIf \u003ccode class=\"markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded\"\u003epage\u003c/code\u003e is not restricted, an attacker can change what file the server includes. Root causes are usually:\u003c/p\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003eMissing input validation or allowlists\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003eConcatenation of user input into file paths\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003eExposed dev/backups or predictable file locations\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eMapping the weakness to CWE: this is typically \u003cstrong class=\"markdown-strong font-bold\"\u003eCWE-22 (Path Traversal)\u003c/strong\u003e and sometimes \u003cstrong class=\"markdown-strong font-bold\"\u003eCWE-98/CWE-94\u003c/strong\u003e if inclusion leads to code execution.\u003c/p\u003e\n\u003chr class=\"markdown-hr my-6 h-px border-0 bg-border\"\u003e\n\u003ch2 class=\"markdown-h2 text-2xl font-bold mt-6 mb-4\"\u003e2 — Recon \u0026amp; parameter discovery (safe, non-destructive)\u003c/h2\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eGoal: enumerate endpoints and parameters that accept file-like input.\u003c/p\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eUseful tools \u0026amp; commands:\u003c/p\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eGather archived URLs\u003c/strong\u003e (public sources)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"markdown-pre rounded-md bg-muted p-4 overflow-x-auto\"\u003e\u003ccode class=\"hljs language-bash markdown-code font-mono text-sm\"\u003egau example.com \u0026gt; urls.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eCrawl \u0026amp; spider\u003c/strong\u003e (Burp Spider / Burp Scanner)\u003c/p\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003eUse Burp’s crawler to enumerate dynamic endpoints and hidden parameters.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eDirectory \u0026amp; param discovery\u003c/strong\u003e (gobuster / ffuf)\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"markdown-pre rounded-md bg-muted p-4 overflow-x-auto\"\u003e\u003ccode class=\"hljs language-bash markdown-code font-mono text-sm\"\u003egobuster \u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e -u https://example.com -w /usr/share/wordlists/dirb/common.txt -x php,html -t 50\n\u003cspan class=\"hljs-comment\"\u003e# or\u003c/span\u003e\nffuf -u https://example.com/FUZZ -w /usr/share/wordlists/common.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eFilter for likely parameters\u003c/strong\u003e (look for names that imply file/include)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"markdown-pre rounded-md bg-muted p-4 overflow-x-auto\"\u003e\u003ccode class=\"hljs language-bash markdown-code font-mono text-sm\"\u003egrep -Eo \u003cspan class=\"hljs-string\"\u003e\"([?\u0026amp;](file|path|page|include|template|doc|view|download)=[^\u0026amp; ]+)\"\u003c/span\u003e urls.txt | \u003cspan class=\"hljs-built_in\"\u003esort\u003c/span\u003e -u\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eFocus on parameters like: \u003ccode class=\"markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded\"\u003efile=\u003c/code\u003e, \u003ccode class=\"markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded\"\u003epage=\u003c/code\u003e, \u003ccode class=\"markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded\"\u003etemplate=\u003c/code\u003e, \u003ccode class=\"markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded\"\u003einc=\u003c/code\u003e, \u003ccode class=\"markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded\"\u003edownload=\u003c/code\u003e, \u003ccode class=\"markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded\"\u003epath=\u003c/code\u003e, \u003ccode class=\"markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded\"\u003edoc=\u003c/code\u003e.\u003c/p\u003e\n\u003chr class=\"markdown-hr my-6 h-px border-0 bg-border\"\u003e\n\u003ch2 class=\"markdown-h2 text-2xl font-bold mt-6 mb-4\"\u003e3 — Manual probing (confirming behavior, low-noise)\u003c/h2\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003ePrinciple: start with non-destructive checks that change \u003cstrong class=\"markdown-strong font-bold\"\u003ebehavior\u003c/strong\u003e only (not data extraction). Always log timestamps and keep tests minimal.\u003c/p\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eCommands for behavioral checks:\u003c/p\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eCompare responses\u003c/strong\u003e (normal vs. manipulated input)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"markdown-pre rounded-md bg-muted p-4 overflow-x-auto\"\u003e\u003ccode class=\"hljs language-bash markdown-code font-mono text-sm\"\u003e\u003cspan class=\"hljs-comment\"\u003e# baseline\u003c/span\u003e\ncurl -s \u003cspan class=\"hljs-string\"\u003e'https://example.com/view.php?page=home'\u003c/span\u003e -o baseline.html\n\u003cspan class=\"hljs-comment\"\u003e# altered (proof of concept must be safe and limited)\u003c/span\u003e\ncurl -s \u003cspan class=\"hljs-string\"\u003e'https://example.com/view.php?page=..%2Fhome'\u003c/span\u003e -o test.html\ndiff -u baseline.html test.html | \u003cspan class=\"hljs-built_in\"\u003ehead\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eIdentify error messages / stack traces\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"markdown-pre rounded-md bg-muted p-4 overflow-x-auto\"\u003e\u003ccode class=\"hljs language-bash markdown-code font-mono text-sm\"\u003ecurl -s \u003cspan class=\"hljs-string\"\u003e'https://example.com/view.php?page=bogus'\u003c/span\u003e -D - | sed -n \u003cspan class=\"hljs-string\"\u003e'1,60p'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eIf the app returns filesystem errors or stack traces, it often leaks the server OS or application paths—useful for classification, not exploitation.\u003c/p\u003e\n\u003cblockquote class=\"markdown-blockquote my-4 border-l-4 border-primary pl-4 italic text-muted-foreground\"\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eSafety note:\u003c/strong\u003e Do not use destructive payloads (e.g., writing files) on targets without express authorization.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003chr class=\"markdown-hr my-6 h-px border-0 bg-border\"\u003e\n\u003ch2 class=\"markdown-h2 text-2xl font-bold mt-6 mb-4\"\u003e4 — Typical LFI indicators and tests (explain, not weaponize)\u003c/h2\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eIndicators that an LFI may be present:\u003c/p\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003eParameter appears in server-side include or \u003ccode class=\"markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded\"\u003erequire\u003c/code\u003e logic.\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003eApplication displays file contents or echoes included templates.\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003eError messages contain absolute or relative path information.\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003eResponse behavior changes when adding traversal sequences.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eCommon minimal checks (lab/authorized testing):\u003c/p\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003eInject harmless traversal sequences and observe response differences (timing, content length, error).\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003eCheck for inclusion of webroot files that are normally accessible (short, non-sensitive files) to verify include mechanics.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eDo \u003cstrong class=\"markdown-strong font-bold\"\u003enot\u003c/strong\u003e publish or run destructive commands (e.g., file writes, webshell creation) on production targets you don’t control.\u003c/p\u003e\n\u003chr class=\"markdown-hr my-6 h-px border-0 bg-border\"\u003e\n\u003ch2 class=\"markdown-h2 text-2xl font-bold mt-6 mb-4\"\u003e5 — Proof-of-concept \u0026amp; evidence collection (responsible)\u003c/h2\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eWhen you have reasonable confidence an LFI exists, collect non-destructive evidence for a report:\u003c/p\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003eThe vulnerable endpoint and exact parameter name.\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003eBaseline and altered responses (diffs/screenshots) showing the difference.\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003eServer headers and any error strings (do not reveal exploited content in public reports).\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003eEnvironment fingerprint (OS, server, app stack) gleaned from safe artifacts.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eExample of documenting a behavioral PoC (conceptual):\u003c/p\u003e\n\u003cpre class=\"markdown-pre rounded-md bg-muted p-4 overflow-x-auto\"\u003e\u003ccode class=\"hljs language-arduino markdown-code font-mono text-sm\"\u003e\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) Baseline: GET /view.php?page=home  -\u0026gt; \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e OK, content X\n\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e) Test:     GET /view.php?page=../../home -\u0026gt; \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e OK, content \u003cspan class=\"hljs-built_in\"\u003ediffers\u003c/span\u003e (diff attached)\n\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e) Observed server header: \u003cspan class=\"hljs-built_in\"\u003eServer\u003c/span\u003e: nginx/\u003cspan class=\"hljs-number\"\u003e1.18\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.0\u003c/span\u003e\n\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e) Error output: \u003cspan class=\"hljs-string\"\u003e\"Warning: include(/var/www/html/home): failed to open stream...\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eThis is enough for vendors to triage without handing them exploit code.\u003c/p\u003e\n\u003chr class=\"markdown-hr my-6 h-px border-0 bg-border\"\u003e\n\u003ch2 class=\"markdown-h2 text-2xl font-bold mt-6 mb-4\"\u003e6 — Escalation scenarios (what makes LFI worse)\u003c/h2\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eLFI becomes significantly more severe if any of the following apply:\u003c/p\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eWritable upload directories\u003c/strong\u003e: Attacker can upload a file (logs, images) and include it later → RCE.\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eLog file inclusion\u003c/strong\u003e: If logs are user-injectable and included, attackers can place payloads in logs.\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eRemote file inclusion allowed (RFI)\u003c/strong\u003e: If remote file includes are enabled, exfil or code execution is easier.\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003ePrivileged DB or exec features\u003c/strong\u003e: Access to sensitive files like config with DB credentials increases blast radius.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eDocument whether such conditions exist during assessment — again, only via observation and safe checks.\u003c/p\u003e\n\u003chr class=\"markdown-hr my-6 h-px border-0 bg-border\"\u003e\n\u003ch2 class=\"markdown-h2 text-2xl font-bold mt-6 mb-4\"\u003e7 — Defenses: code and deployment fixes\u003c/h2\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eConcrete, actionable mitigations developers can apply.\u003c/p\u003e\n\u003ch3 class=\"markdown-h3 text-xl font-bold mt-6 mb-4\"\u003eA. Code-level protections\u003c/h3\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eAllowlist directories\u003c/strong\u003e (never accept arbitrary paths):\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"markdown-pre rounded-md bg-muted p-4 overflow-x-auto\"\u003e\u003ccode class=\"hljs language-php markdown-code font-mono text-sm\"\u003e\u003cspan class=\"hljs-variable\"\u003e$allowed\u003c/span\u003e = [\u003cspan class=\"hljs-string\"\u003e'home'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'about'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'contact'\u003c/span\u003e];\n\u003cspan class=\"hljs-variable\"\u003e$page\u003c/span\u003e = \u003cspan class=\"hljs-variable\"\u003e$_GET\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'page'\u003c/span\u003e] ?? \u003cspan class=\"hljs-string\"\u003e'home'\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!\u003cspan class=\"hljs-title function_ invoke__\"\u003ein_array\u003c/span\u003e(\u003cspan class=\"hljs-variable\"\u003e$page\u003c/span\u003e, \u003cspan class=\"hljs-variable\"\u003e$allowed\u003c/span\u003e)) { \u003cspan class=\"hljs-title function_ invoke__\"\u003ehttp_response_code\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e404\u003c/span\u003e); \u003cspan class=\"hljs-keyword\"\u003eexit\u003c/span\u003e; }\n\u003cspan class=\"hljs-keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003e__DIR__\u003c/span\u003e . \u003cspan class=\"hljs-string\"\u003e'/pages/'\u003c/span\u003e . \u003cspan class=\"hljs-variable\"\u003e$page\u003c/span\u003e . \u003cspan class=\"hljs-string\"\u003e'.php'\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eUse realpath + validation\u003c/strong\u003e:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"markdown-pre rounded-md bg-muted p-4 overflow-x-auto\"\u003e\u003ccode class=\"hljs language-php markdown-code font-mono text-sm\"\u003e\u003cspan class=\"hljs-variable\"\u003e$base\u003c/span\u003e = \u003cspan class=\"hljs-title function_ invoke__\"\u003erealpath\u003c/span\u003e(\u003cspan class=\"hljs-keyword\"\u003e__DIR__\u003c/span\u003e . \u003cspan class=\"hljs-string\"\u003e'/pages'\u003c/span\u003e) . DIRECTORY_SEPARATOR;\n\u003cspan class=\"hljs-variable\"\u003e$path\u003c/span\u003e = \u003cspan class=\"hljs-title function_ invoke__\"\u003erealpath\u003c/span\u003e(\u003cspan class=\"hljs-variable\"\u003e$base\u003c/span\u003e . \u003cspan class=\"hljs-variable\"\u003e$_GET\u003c/span\u003e[\u003cspan class=\"hljs-string\"\u003e'page'\u003c/span\u003e]);\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable\"\u003e$path\u003c/span\u003e === \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e || \u003cspan class=\"hljs-title function_ invoke__\"\u003estrpos\u003c/span\u003e(\u003cspan class=\"hljs-variable\"\u003e$path\u003c/span\u003e, \u003cspan class=\"hljs-variable\"\u003e$base\u003c/span\u003e) !== \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) { \u003cspan class=\"hljs-title function_ invoke__\"\u003ehttp_response_code\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e403\u003c/span\u003e); \u003cspan class=\"hljs-keyword\"\u003eexit\u003c/span\u003e; }\n\u003cspan class=\"hljs-keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003e$path\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eAvoid dynamic includes\u003c/strong\u003e where possible — use routing or explicit mappings.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 class=\"markdown-h3 text-xl font-bold mt-6 mb-4\"\u003eB. Configuration \u0026amp; server hardening\u003c/h3\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eStore uploads outside webroot\u003c/strong\u003e and serve via safe proxy that enforces content-type checks.\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eDisable risky PHP settings\u003c/strong\u003e (\u003ccode class=\"markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded\"\u003eallow_url_include = Off\u003c/code\u003e) and ensure \u003ccode class=\"markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded\"\u003eopen_basedir\u003c/code\u003e is set to restrict accessible paths.\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eRemove verbose error messages\u003c/strong\u003e from production (no stack traces to end-users).\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eNginx example to block obvious backup files:\u003c/p\u003e\n\u003cpre class=\"markdown-pre rounded-md bg-muted p-4 overflow-x-auto\"\u003e\u003ccode class=\"hljs language-nginx markdown-code font-mono text-sm\"\u003elocation ~* \\.(zip|tar|sql|bak)$ {\n    deny all;\n    return 403;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 class=\"markdown-h3 text-xl font-bold mt-6 mb-4\"\u003eC. Principle of least privilege\u003c/h3\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003eApplication processes should not run as root.\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003eLimit file system permissions—application should only read files it needs.\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr class=\"markdown-hr my-6 h-px border-0 bg-border\"\u003e\n\u003ch2 class=\"markdown-h2 text-2xl font-bold mt-6 mb-4\"\u003e8 — Detection \u0026amp; monitoring (what defenders should watch for)\u003c/h2\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eSearch logs for suspicious patterns that may indicate traversal attempts:\u003c/p\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003eWebserver logs:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"markdown-pre rounded-md bg-muted p-4 overflow-x-auto\"\u003e\u003ccode class=\"hljs language-bash markdown-code font-mono text-sm\"\u003e\u003cspan class=\"hljs-comment\"\u003e# basic heuristic search\u003c/span\u003e\ngrep -Ei \u003cspan class=\"hljs-string\"\u003e\"(\\.\\./|\\.\\.\\\\|%2e%2e|etc/passwd|boot.ini|/proc/self)\"\u003c/span\u003e /var/log/nginx/access.log | \u003cspan class=\"hljs-built_in\"\u003etail\u003c/span\u003e -n 200\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003eMonitor application errors for include/failed-open messages:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"markdown-pre rounded-md bg-muted p-4 overflow-x-auto\"\u003e\u003ccode class=\"hljs language-bash markdown-code font-mono text-sm\"\u003egrep -i \u003cspan class=\"hljs-string\"\u003e\"failed to open stream\"\u003c/span\u003e /var/log/php_errors.log\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003eAlert on attempts to access sensitive paths (e.g., \u003ccode class=\"markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded\"\u003e/etc/passwd\u003c/code\u003e, \u003ccode class=\"markdown-code font-mono text-sm bg-muted px-1.5 py-0.5 rounded\"\u003e/proc/self/environ\u003c/code\u003e) from the webapp.\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr class=\"markdown-hr my-6 h-px border-0 bg-border\"\u003e\n\u003ch2 class=\"markdown-h2 text-2xl font-bold mt-6 mb-4\"\u003e9 — Responsible disclosure checklist\u003c/h2\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eIf you find an LFI (authorized testing):\u003c/p\u003e\n\u003col class=\"markdown-ol my-4 ml-6 list-decimal\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eDocument\u003c/strong\u003e: endpoint, parameter, controlled test inputs, server fingerprints, and diffs/screenshots.\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eAvoid destructive steps\u003c/strong\u003e: do not write files, do not trigger RCE in the wild.\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eReport privately\u003c/strong\u003e to the vendor/owner with a clear remediation suggestion (allowlist + realpath + config changes).\u003c/li\u003e\n\u003cli class=\"markdown-li my-2\"\u003e\u003cstrong class=\"markdown-strong font-bold\"\u003eCoordinate\u003c/strong\u003e timeline for patching and public disclosure per vendor policy.\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr class=\"markdown-hr my-6 h-px border-0 bg-border\"\u003e\n\u003ch2 class=\"markdown-h2 text-2xl font-bold mt-6 mb-4\"\u003e10 — Lab practice (safe environments)\u003c/h2\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eSet up legal, isolated labs to practice:\u003c/p\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003eOWASP Juice Shop (web vulnerabilities playground):\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"markdown-pre rounded-md bg-muted p-4 overflow-x-auto\"\u003e\u003ccode class=\"hljs language-bash markdown-code font-mono text-sm\"\u003edocker run --\u003cspan class=\"hljs-built_in\"\u003erm\u003c/span\u003e -p 3000:3000 bkimminich/juice-shop\n\u003cspan class=\"hljs-comment\"\u003e# browse http://localhost:3000\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul class=\"markdown-ul my-4 ml-6 list-disc\"\u003e\n\u003cli class=\"markdown-li my-2\"\u003eDVWA (Deliberately Vulnerable Web App) or custom containers with isolated LFI examples.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003ePractice detection and safe evidence collection in these environments before attempting any real-world testing.\u003c/p\u003e\n\u003chr class=\"markdown-hr my-6 h-px border-0 bg-border\"\u003e\n\u003ch2 class=\"markdown-h2 text-2xl font-bold mt-6 mb-4\"\u003eConclusion\u003c/h2\u003e\n\u003cp class=\"markdown-p my-4 leading-relaxed\"\u003eLFI issues are often the result of simple, fixable mistakes: dynamic includes and insufficient input validation. The most important habit for a researcher or dev is to \u003cstrong class=\"markdown-strong font-bold\"\u003eassume input is hostile\u003c/strong\u003e, use allowlists, resolve paths safely (realpath), and run the app with least privilege. When you find an LFI, document behavior, avoid destructive steps, and help the owner patch the root cause.\u003c/p\u003e"])</script><script>self.__next_f.push([1,"7:[\"$\",\"div\",null,{\"className\":\"pt-12\",\"children\":[\"$\",\"article\",null,{\"className\":\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8\",\"children\":[[\"$\",\"header\",null,{\"className\":\"mb-12 border-b pb-8\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-10\"}],[\"$\",\"h1\",null,{\"className\":\"text-4xl md:text-5xl font-bold text-foreground mb-6\",\"children\":\"Uncovering Local File Inclusion Vulnerabilities: A Practical Approach to Path Traversal Hunting\"}],[\"$\",\"div\",null,{\"className\":\"flex items-center gap-6 text-sm text-muted-foreground\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-center gap-2\",\"children\":[\"$\",\"span\",null,{\"children\":[\"By \",\"Rosemary\"]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"span\",null,{\"children\":\"11/3/2025\"}]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"prose prose-lg max-w-none\",\"dangerouslySetInnerHTML\":{\"__html\":\"$10\"}}],[\"$\",\"div\",null,{\"className\":\"mt-12 pt-8 border-t\",\"children\":[\"$\",\"$L5\",null,{\"href\":\"/posts\",\"className\":\"text-primary hover:text-primary/80 transition-colors font-semibold inline-flex items-center gap-2\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":18,\"height\":18,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-arrow-right rotate-180\",\"children\":[[\"$\",\"path\",\"1ays0h\",{\"d\":\"M5 12h14\"}],[\"$\",\"path\",\"xquz4c\",{\"d\":\"m12 5 7 7-7 7\"}],\"$undefined\"]}],\"Back to Posts\"]}]}]]}]}]\na:null\ne:[[\"$\",\"title\",\"0\",{\"children\":\"Uncovering Local File Inclusion Vulnerabilities: A Practical Approach to Path Traversal Hunting\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"A blog post by Rosemary about cybersecurity\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\"}]]\n"])</script></body></html>